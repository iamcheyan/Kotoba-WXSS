<view class="body theme-magic">
<view class="app">
        <view class="app-header">
            <view class="header-left">
                <view class="branding">
                    <text class="branding-logo" aria-hidden="true">
                        <image src="../../static/logo.svg" alt="Kotoba" width="42" height="42" />
                    </text>
                    <view data-href="/" class="branding-title">Ë®ÄËëâ</view>
                </view>
            </view>
            
            <view class="header-actions">
                <button id="autoPronounceBtn" class="ghost-button" title="Ëá™ÂãïÁô∫Èü≥Ôºà„ÇØ„É™„ÉÉ„ÇØ„ÅßÂàáÊõøÔºâ" aria-pressed="false" aria-label="Ëá™ÂãïÁô∫Èü≥">
                    Ëá™ÂãïÁô∫Èü≥
                </button>
                <button id="keyboard-toggle" class="ghost-button" type="button" title="Virtual Keyboard" aria-label="ËôöÊãüÈîÆÁõò">
                    A
                </button>
                
                <view class="mode-switcher">
                <button id="mode-input" class="mode-btn active" title="ÂÖ•Âäõ„É¢„Éº„Éâ">
                    <image src="../../static/icons/mode-input.png" style="width:18px;height:18px" />
                </button>
                <button id="mode-puzzle" class="mode-btn" title="„Éë„Ç∫„É´„É¢„Éº„Éâ">
                    <image src="../../static/icons/mode-puzzle.png" style="width:18px;height:18px" />
                </button>
                <button id="mode-play" class="mode-btn" title="ÂÜçÁîü„É¢„Éº„Éâ" style="display: none;">
                    <image src="../../static/icons/mode-play.png" style="width:18px;height:18px" />
                </button>
                </view>
                
                <button id="open-settings" class="ghost-button" bindtap="openDictionaryModal">Ë®≠ÂÆö</button>
                <button id="headerLeaderboardBtn" class="header-leaderboard-btn" title="„É©„É≥„Ç≠„É≥„Ç∞" style="display:none;">
                    <image class="icon" src="../../static/icons/leaderboard.png" style="width:18px;height:18px" />
                </button>

                
                <view class="user-account">
                    
                    <view id="guestProfile" class="user-profile" style="display: flex;">
                        <button class="guest-menu-trigger" aria-label="„É°„Éã„É•„Éº">
                            <image src="../../static/icons/user.png" style="width:20px;height:20px" />
                        </button>
                        <view id="guestMenu" class="user-menu">
                            <button id="loginButtonMenu" class="user-menu-item">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                                    <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
                                    <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
                                    <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
                                    <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
                                </svg>
                                <text>„É≠„Ç∞„Ç§„É≥</text>
                            </button>
                            <view class="user-menu-divider"></view>
                            <button id="dictionaryButtonMenuGuest" class="user-menu-item">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                                    <line x1="10" y1="8" x2="16" y2="8"></line>
                                    <line x1="10" y1="12" x2="16" y2="12"></line>
                                    <line x1="10" y1="16" x2="14" y2="16"></line>
                                </svg>
                                <text>ËæûÊõ∏„ÇíÂàá„ÇäÊõø„Åà</text>
                            </button>
                            <button id="settingsButtonMenuGuest" class="user-menu-item">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="3"></circle>
                                    <path d="M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24"></path>
                                </svg>
                                <text>Ë®≠ÂÆö</text>
                            </button>
                            <button id="clearEnvButtonGuest" class="user-menu-item">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M3 6h18"></path>
                                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
                                    <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                </svg>
                                <text>Áí∞Â¢É„Çí„ÇØ„É™„Ç¢</text>
                            </button>
                            <button id="downloadOfflineGuest" class="user-menu-item">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="7 10 12 15 17 10"></polyline>
                                    <line x1="12" y1="15" x2="12" y2="3"></line>
                                </svg>
                                <text>„Ç™„Éï„É©„Ç§„É≥Áî®„Å´„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</text>
                            </button>
                            <view class="user-menu-divider"></view>
                            <view id="helpLinkUser" class="user-menu-item" data-href="/help.html" >
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <path d="M9 9a3 3 0 1 1 5.2 2.2c-.7.7-1.2 1.1-1.2 2.3"></path>
                                    <line x1="12" y1="17" x2="12" y2="17"></line>
                                </svg>
                                <text>„Éò„É´„Éó</text>
                            </view>
                            <button id="installPWAGuest" class="user-menu-item" style="display: none;">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="7 10 12 15 17 10"></polyline>
                                    <line x1="12" y1="15" x2="12" y2="3"></line>
                                </svg>
                                <text>„Ç¢„Éó„É™„Çí„Ç§„É≥„Çπ„Éà„Éº„É´</text>
                            </button>
                        </view>
                    </view>
                    
                    <view id="userProfile" class="user-profile" style="display: none;">
                        <image id="userAvatar" class="user-avatar" src="" alt="User" />
                        <view id="userMenu" class="user-menu">
                            <view class="user-menu-header">
                                <image id="userAvatarMenu" class="user-avatar-large" src="" alt="User" />
                                <view class="user-info">
                                    <view id="userNameMenu" class="user-name"></view>
                                    <view id="userEmailMenu" class="user-email"></view>
                                </view>
                            </view>
                            <view class="user-menu-divider"></view>
                            <button id="syncDataButton" class="user-menu-item">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="23 4 23 10 17 10"></polyline>
                                    <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
                                </svg>
                                <text>„Éá„Éº„Çø„ÇíÂêåÊúü</text>
                            </button>
                            <button id="viewWrongWordsButton" class="user-menu-item">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                    <line x1="16" y1="2" x2="16" y2="6"></line>
                                    <line x1="8" y1="2" x2="8" y2="6"></line>
                                    <line x1="3" y1="10" x2="21" y2="10"></line>
                                </svg>
                                <text>Áµ±Ë®à</text>
                            </button>
                            <button id="practiceWrongWordsButton" class="user-menu-item">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                                    <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                                </svg>
                                <text>ÈåØÈ°å„ÇíÁ∑¥Áøí</text>
                            </button>
                            
                            <view class="user-menu-divider"></view>
                            <button id="dictionaryButtonMenu" class="user-menu-item">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                                    <line x1="10" y1="8" x2="16" y2="8"></line>
                                    <line x1="10" y1="12" x2="16" y2="12"></line>
                                    <line x1="10" y1="16" x2="14" y2="16"></line>
                                </svg>
                                <text>ËæûÊõ∏„ÇíÂàá„ÇäÊõø„Åà</text>
                            </button>
                            <button id="settingsButtonMenu" class="user-menu-item">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="3"></circle>
                                    <path d="M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24"></path>
                                </svg>
                                <text>Ë®≠ÂÆö</text>
                            </button>
                            <button id="clearEnvButton" class="user-menu-item">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M3 6h18"></path>
                                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
                                    <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                </svg>
                                <text>Áí∞Â¢É„Çí„ÇØ„É™„Ç¢</text>
                            </button>
                            <button id="downloadOfflineUser" class="user-menu-item">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="7 10 12 15 17 10"></polyline>
                                    <line x1="12" y1="15" x2="12" y2="3"></line>
                                </svg>
                                <text>„Ç™„Éï„É©„Ç§„É≥Áî®„Å´„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</text>
                            </button>
                            <view class="user-menu-divider"></view>
                            <button id="switchAccountButton" class="user-menu-item">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="9" cy="7" r="4"></circle>
                                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                </svg>
                                <text>„Ç¢„Ç´„Ç¶„É≥„Éà„ÇíÂàá„ÇäÊõø„Åà</text>
                            </button>
                            <button id="logoutButton" class="user-menu-item logout">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                    <polyline points="16 17 21 12 16 7"></polyline>
                                    <line x1="21" y1="12" x2="9" y2="12"></line>
                                </svg>
                                <text>„É≠„Ç∞„Ç¢„Ç¶„Éà</text>
                            </button>
                            <view class="user-menu-divider"></view>
                            <view id="helpLinkUser" class="user-menu-item" data-href="/help.html" >
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <path d="M9 9a3 3 0 1 1 5.2 2.2c-.7.7-1.2 1.1-1.2 2.3"></path>
                                    <line x1="12" y1="17" x2="12" y2="17"></line>
                                </svg>
                                <text>„Éò„É´„Éó</text>
                            </view>
                            <button id="installPWAUser" class="user-menu-item" style="display: none;">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="7 10 12 15 17 10"></polyline>
                                    <line x1="12" y1="15" x2="12" y2="3"></line>
                                </svg>
                                <text>„Ç¢„Éó„É™„Çí„Ç§„É≥„Çπ„Éà„Éº„É´</text>
                            </button>
                        </view>
                    </view>
                </view>
                
                
            </view>
        </view>

        <view class="main">
            <view id="loading-indicator" class="loading hidden" role="status" aria-live="polite">
                <view class="spinner" aria-hidden="true"></view>
                <view class="loading-text">Ë™≠„ÅøËæº„Åø‰∏≠‚Ä¶</view>
            </view>

            <view id="question" class="card game-card">
                <view class="word-container">
                    <view id="question-word" class="word" aria-live="polite">
                        <view class="word-with-furigana">
                            <text class="furigana" wx:if="{{questionReading}}">{{questionReading}}</text>
                            <text class="kanji">{{questionWord}}</text>
                        </view>
                    </view>
                    <button id="tts-button" type="button" class="tts-button" title="Áô∫Èü≥„ÇíËÅû„Åè" aria-label="Áô∫Èü≥„ÇíËÅû„Åè" bindtap="playTTS">
                        <image class="tts-icon" src="../../static/icons/tts.png" style="width:18px;height:18px" />
                        <text class="sr-only">Áô∫Èü≥„ÇíËÅû„Åè</text>
                    </button>
                </view>
                <view id="question-meaning" class="meaning">{{questionMeaning}}</view>
                <view id="question-reading" class="reading">{{questionReading}}</view>
                <view class="romaji-line"><view id="question-romaji" class="romaji">{{questionRomaji}}</view><view class="romaji-help">?</view></view>
                <view id="empty-wrong-words" class="empty-state hidden" aria-live="polite">
                    <view class="empty-illustration" aria-hidden="true">ü´ß</view>
                    <view>„Åæ„Å†ÈñìÈÅï„ÅÑ„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</view>
                    <view>ÁèæÂú®„ÅÆÈåØÈ°åÊú¨„ÅØÁ©∫„Åß„Åô„ÄÇ„Åæ„Åö„ÅØÈÄöÂ∏∏„ÅÆËæûÊõ∏„ÅßÁ∑¥Áøí„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ</view>
                    <button id="backToDefaultDict" class="primary-button" type="button">Êó¢ÂÆö„ÅÆËæûÊõ∏„Å∏</button>
                </view>
                <form id="answer-form" class="answer-form" autocomplete="off">
                    
                    <view id="input-mode-container" class="mode-container">
                        <label class="sr-only" for="answer-input">Á≠î„Åà„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ</label>
                        <input id="answer-input" type="text" inputmode="text" autocomplete="off" placeholder="" bindinput="onAnswerInput" value="{{answerText}}" />
                    </view>
                    
                    
                    <view id="puzzle-mode-container" class="mode-container hidden">
                        <view id="puzzle-answer-area" class="puzzle-answer-area">
                            
                        </view>
                        <view id="puzzle-options-area" class="puzzle-options-area">
                            
                        </view>
                    </view>
                    
                    <view class="actions">
                        <button type="submit" id="answer-submit" bindtap="onSubmitAnswer">Á≠î„Åà„Çã</button>
                        <button type="button" id="skip-button" class="skip-button" title="„Åì„ÅÆÂïèÈ°å„Çí„Çπ„Ç≠„ÉÉ„Éó" bindtap="nextQuestion">„Çπ„Ç≠„ÉÉ„Éó</button>
                        <button type="button" id="replay-button" class="hidden">ÈáçÂê¨</button>
                        <button type="button" id="next-button" class="hidden">Ê¨°„Å∏</button>
                    </view>
                </form>
            </view>
            
            <view class="game-progress-panel" aria-label="Â≠¶ÁøíÈÄ≤Êçó" style="display: none;">
                <view class="player-stats">
                    <view class="player-avatar">
                        <view class="avatar-ring level-1">
                            <view class="avatar-icon" id="game-avatar-container">
                                <image id="gameUserAvatar" class="game-user-avatar hidden" src="" alt="User" />
                                <text id="gameDefaultAvatar" class="game-default-avatar">‚öîÔ∏è</text>
                            </view>
                        </view>
                        <view class="level-badge" id="level-badge">Lv.1</view>
                    </view>
                    
                    <view class="player-info">
                        <view class="exp-container">
                            <view class="exp-header">
                                <text class="exp-label">ÁµåÈ®ìÂÄ§</text>
                                <button id="progress-reset" class="progress-reset-btn" type="button" title="ÈÄ≤Êçó„Çí„É™„Çª„ÉÉ„Éà">
                                    <image src="../../static/icons/reset.png" style="width:14px;height:14px" />
                                </button>
                            </view>
                            <view class="exp-bar-wrapper">
                                <view id="exp-bar" class="exp-bar" role="progressbar">
                                    <view id="exp-fill" class="exp-bar-fill"></view>
                                    <view class="exp-bar-shine"></view>
                                </view>
                                <view class="exp-text" id="exp-text">0 / 100</view>
                            </view>
                        </view>
                        
                        <view class="stats-grid">
                            <view class="stat-item stat-correct">
                                <image src="../../static/icons/stat-correct.png" style="width:18px;height:18px" />
                                <text class="stat-value" id="correct-stat">0</text>
                            </view>
                            <view class="stat-item stat-wrong">
                                <image src="../../static/icons/stat-wrong.png" style="width:18px;height:18px" />
                                <text class="stat-value" id="wrong-stat">0</text>
                            </view>
                            <view class="stat-item stat-combo">
                                <image src="../../static/icons/stat-combo.png" style="width:18px;height:18px" />
                                <text class="stat-value" id="combo-stat">0</text>
                            </view>
                            <view class="stat-item stat-total">
                                <image src="../../static/icons/stat-total.png" style="width:18px;height:18px" />
                                <text class="stat-value" id="total-stat">0</text>
                            </view>
                        </view>
                    </view>
                </view>
                
                <view class="progress-text-info" id="progress-text-info">
                    <text id="progress-fraction">{{progressFraction}}</text>
                    <text class="progress-percentage" id="progress-percentage">{{progressPercentage}}</text>
                    <text id="dictionary-name" class="dictionary-name" bindtap="pickDictionary">{{dictionaryName}}</text>
                </view>
            </view>
        </view>
    </view>

    
    <view id="alerts" class="alerts" aria-live="polite"></view>

    <view id="modal-backdrop" class="modal-backdrop {{showBackdrop ? '' : 'hidden'}}" bindtap="closeModals"></view>

    <view id="dictionary-modal" class="modal {{showDictionaryModal ? '' : 'hidden'}}" role="dialog" aria-modal="true" aria-labelledby="dictionary-modal-title">
        <view class="modal-header">
            <view id="dictionary-modal-title">ËæûÊõ∏ÈÅ∏Êäû</view>
            <button type="button" class="modal-close" bindtap="closeModals" aria-label="Èñâ„Åò„Çã">√ó</button>
        </view>
        <view class="modal-body dictionary-modal-body">
            <view class="dictionary-select-group">
                <text>Âà©Áî®„Åô„ÇãËæûÊõ∏„ÇíÈÅ∏Êäû</text>
                <picker mode="selector" range="{{dictNames}}" value="{{selectedDictIndex}}" bindchange="onDictPickerChange">
                    <view class="picker-display">
                        <text class="picker-value">{{dictNames[selectedDictIndex]}}</text>
                        <text class="select-arrow">‚ñæ</text>
                    </view>
                </picker>
            </view>
            <view class="rate-control">
                <text>Ë™≠„Åø‰∏ä„ÅíÈÄüÂ∫¶:</text>
                <slider min="0.5" max="2" step="0.1" value="{{speechRate}}" show-value bindchange="onRateChange" />
            </view>
        </view>
        <view class="modal-footer">
            <button type="button" class="ghost-button" bindtap="closeModals">„Ç≠„É£„É≥„Çª„É´</button>
            <button type="button" id="dictionary-save" bindtap="onDictionarySave">Á¢∫Ë™ç</button>
        </view>
    </view>

    <view id="settings-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="settings-modal-title">
        <view class="modal-header">
            <view id="settings-modal-title">Ë®≠ÂÆö</view>
            <button type="button" class="modal-close" data-close="modal" aria-label="Èñâ„Åò„Çã">√ó</button>
        </view>
        <view class="modal-body">
            <view class="settings-checkbox-grid">
                <label class="checkbox">
                    <input type="checkbox" id="toggle-reading" checked />
                    Ë™≠„ÅøÊñπ„ÇíË°®Á§∫„Åô„Çã
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="toggle-romaji" checked />
                    „É≠„Éº„ÉûÂ≠ó„ÇíË°®Á§∫„Åô„Çã
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="toggle-placeholder" checked />
                    ÂÖ•Âäõ„Éí„É≥„Éà„ÇíË°®Á§∫„Åô„Çã
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="toggle-katakana" />
                    „Ç´„Çø„Ç´„Éä„Å´„ÇÇÊåØ„Çä‰ªÆÂêç„ÇíË°®Á§∫„Åô„Çã
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="toggle-furigana" checked />
                    ÊåØ„Çä‰ªÆÂêç„ÇíË°®Á§∫„Åô„Çã
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="toggle-auto-pronunciation" />
                    Ëá™ÂãïÁô∫Èü≥
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="toggle-combo-sound" checked />
                    ÈÄ£ÊíÉÈü≥Êïà
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="toggle-sound-effects" checked />
                    ÂäπÊûúÈü≥ÔºàÊ≠£Ëß£/Â†±ÈÖ¨Ôºâ
                </label>
                <label class="checkbox">
                    <input type="checkbox" id="toggle-haptics" checked />
                    Ëß¶ÊÑüÔºàÂØæÂøú„Éá„Éê„Ç§„ÇπÔºâ
                </label>
                <view class="sound-test-section" style="display: none;">
                    <button type="button" id="test-combo-sound" class="ghost-button">
                        üîä Èü≥Êïà„ÉÜ„Çπ„Éà
                    </button>
                    <view class="combo-sound-tests">
                        <view>ÈÄ£ÊíÉÈü≥Êïà„ÉÜ„Çπ„Éà</view>
                        <view class="combo-test-buttons">
                            <button type="button" class="combo-test-btn" data-combo="3">3ÈÄ£ÊíÉ üî•</button>
                            <button type="button" class="combo-test-btn" data-combo="5">5ÈÄ£ÊíÉ ‚ú®</button>
                            <button type="button" class="combo-test-btn" data-combo="10">10ÈÄ£ÊíÉ üéâ</button>
                            <button type="button" class="combo-test-btn" data-combo="20">20ÈÄ£ÊíÉ üåü</button>
                            <button type="button" class="combo-test-btn" data-combo="30">30ÈÄ£ÊíÉ ü¶Ñ</button>
                            <button type="button" class="combo-test-btn" data-combo="50">50ÈÄ£ÊíÉ üèÜ</button>
                            <button type="button" class="combo-test-btn" data-combo="60">60ÈÄ£ÊíÉ üèÜ</button>
                            <button type="button" class="combo-test-btn" data-combo="70">70ÈÄ£ÊíÉ üèÜ</button>
                            <button type="button" class="combo-test-btn" data-combo="80">80ÈÄ£ÊíÉ üèÜ</button>
                            <button type="button" class="combo-test-btn" data-combo="90">90ÈÄ£ÊíÉ üèÜ</button>
                            <button type="button" class="combo-test-btn" data-combo="100">100ÈÄ£ÊíÉ üëë</button>
                            <button type="button" class="combo-test-btn" data-combo="200">200ÈÄ£ÊíÉ üíé</button>
                            <button type="button" class="combo-test-btn" data-combo="300">300ÈÄ£ÊíÉ üöÄ</button>
                            <button type="button" class="combo-test-btn" data-combo="500">500ÈÄ£ÊíÉ üåå</button>
                            <button type="button" class="combo-test-btn" data-combo="1000">1000ÈÄ£ÊíÉ üßô‚Äç‚ôÇÔ∏è</button>
                        </view>
                    </view>
                </view>
            </view>
        </view>
        <view class="modal-footer">
            <button type="button" class="ghost-button" data-close="modal">„Ç≠„É£„É≥„Çª„É´</button>
            <button type="button" id="settings-save">Á¢∫Ë™ç</button>
        </view>
    </view>

    
    <view id="wrong-words-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="wrong-words-modal-title">
        <view class="modal-header">
            <view id="wrong-words-modal-title">Áµ±Ë®à</view>
            <button type="button" class="modal-close" data-close="modal" aria-label="Èñâ„Åò„Çã">√ó</button>
        </view>
        <view class="modal-body wrong-words-body">
            <view class="wrong-words-stats">
                <view class="stat-card stat-correct">
                    <view class="stat-number" id="correct-count">0</view>
                    <view class="stat-label">Ê≠£Ëß£Êï∞</view>
                </view>
                <view class="stat-card stat-wrong">
                    <view class="stat-number" id="wrong-count">0</view>
                    <view class="stat-label">ÈåØÈ°åÊï∞</view>
                </view>
            </view>
            <view class="wrong-words-actions">
                <button type="button" id="practice-wrong-words" class="ghost-button primary-button">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="5 3 19 12 5 21 5 3"></polygon>
                    </svg>
                    ÈåØÈ°å„ÇíÁ∑¥Áøí
                </button>
                <button type="button" id="clear-all-wrong-words" class="ghost-button danger-button" title="„Åô„Åπ„Å¶„ÇØ„É™„Ç¢">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="3 6 5 6 21 6"></polyline>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                    </svg>
                </button>
            </view>
            <view id="wrong-words-list" class="wrong-words-list">
                
            </view>
            <view id="wrong-words-pagination" class="pagination hidden">
                <button id="prev-page" class="pagination-btn" disabled>
                    <image src="../../static/icons/chevron-left.png" style="width:16px;height:16px" />
                    Ââç„Å∏
                </button>
                <view class="pagination-info">
                    <text id="current-page">1</text> / <text id="total-pages">1</text>
                </view>
                <button id="next-page" class="pagination-btn" disabled>
                    Ê¨°„Å∏
                    <image src="../../static/icons/chevron-right.png" style="width:16px;height:16px" />
                </button>
            </view>
        </view>
    </view>

    
    <view id="offline-download-modal" class="modal hidden" role="dialog" aria-modal="true">
        <view class="modal-header">
            <view>„Ç™„Éï„É©„Ç§„É≥‰ΩøÁî®</view>
            <button type="button" class="modal-close" data-close="offline-modal" aria-label="Èñâ„Åò„Çã">√ó</button>
        </view>
        <view class="modal-body">
            <view style="font-size: 14px; color: var(--text-secondary, #64748b); margin-bottom: 16px;">
                „Åô„Åπ„Å¶„ÅÆ„É™„ÇΩ„Éº„Çπ„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Å¶„ÄÅÂÆåÂÖ®„Å´„Ç™„Éï„É©„Ç§„É≥„Åß‰ΩøÁî®„Åß„Åç„Çã„Çà„ÅÜ„Å´„Åó„Åæ„Åô„ÄÇ
            </view>
            <view id="offline-status" style="margin: 16px 0; font-size: 14px; text-align: center; min-height: 24px;">
                
            </view>
            <button type="button" id="download-for-offline" class="ghost-button" style="width: 100%; margin-top: 8px;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 8px;">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                „Ç™„Éï„É©„Ç§„É≥Áî®„Å´„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
            </button>
        </view>
    </view>

    
    <view id="leaderboard-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="leaderboard-modal-title">
                <view class="modal-header">
            <view id="leaderboard-modal-title">„É©„É≥„Ç≠„É≥„Ç∞</view>
            <button type="button" class="modal-close" data-close="modal" aria-label="Èñâ„Åò„Çã">√ó</button>
        </view>
        <view class="modal-body leaderboard-body">
            <view class="leaderboard-stats">
                <view class="leaderboard-stat-card">
                    <view class="stat-number" id="my-rank">-</view>
                    <view class="stat-label">Ëá™ÂàÜ„ÅÆÈ†Ü‰Ωç</view>
                </view>
                <view class="leaderboard-stat-card">
                    <view class="stat-number" id="my-score">0</view>
                    <view class="stat-label">Ëá™ÂàÜ„ÅÆ„Çπ„Ç≥„Ç¢</view>
                </view>
                <view class="leaderboard-stat-card">
                    <view class="stat-number" id="total-players">0</view>
                    <view class="stat-label">„Éó„É¨„Ç§„É§„ÉºÊï∞</view>
                </view>
            </view>
            
            <view class="leaderboard-actions" style="display:none;"></view>
            
            <view class="leaderboard-list" id="leaderboard-list">
                <view class="leaderboard-loading">
                    <view class="spinner" style="width: 24px; height: 24px; margin: 0 auto;"></view>
                    <view>Ë™≠„ÅøËæº„Åø‰∏≠...</view>
                </view>
            </view>
            <view style="margin-top: 8px; text-align: right;">
                <button type="button" id="show-scoring-rules" class="ghost-button" title="Ë®àÁÆó„É´„Éº„É´">Ë®àÁÆó„É´„Éº„É´</button>
            </view>
            
            <view class="leaderboard-pagination" id="leaderboard-pagination" style="display: none;">
                <button id="prev-leaderboard-page" class="pagination-btn" disabled>
                    <image src="../../static/icons/chevron-left.png" style="width:16px;height:16px" />
                    Ââç„Å∏
                </button>
                <view class="pagination-info">
                    <text id="current-leaderboard-page">1</text> / <text id="total-leaderboard-pages">1</text>
                </view>
                <button id="next-leaderboard-page" class="pagination-btn" disabled>
                    Ê¨°„Å∏
                    <image src="../../static/icons/chevron-right.png" style="width:16px;height:16px" />
                </button>
            </view>
        </view>
    </view>

    
    <view id="pwa-install-modal" class="modal hidden" role="dialog" aria-modal="true">
        <view class="modal-header">
            <view>„Ç¢„Éó„É™„Çí„Ç§„É≥„Çπ„Éà„Éº„É´</view>
            <button type="button" class="modal-close" data-close="pwa-modal" aria-label="Èñâ„Åò„Çã">√ó</button>
        </view>
        <view class="modal-body">
            <view id="pwa-install-content">
                <view class="pwa-step" id="pwa-step-1">
                    <view class="pwa-icon">üì±</view>
                    <view>„Ç≠„É£„ÉÉ„Ç∑„É•„Çí„ÇØ„É™„Ç¢‰∏≠...</view>
                    <view class="pwa-progress">
                        <view class="pwa-progress-bar" id="pwa-progress-1" style="width: 0%"></view>
                    </view>
                    <view class="pwa-progress-text" id="pwa-progress-text-1">Ê∫ñÂÇô‰∏≠...</view>
                </view>
                <view class="pwa-step hidden" id="pwa-step-2">
                    <view class="pwa-icon">‚¨áÔ∏è</view>
                    <view>„É™„ÇΩ„Éº„Çπ„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ‰∏≠...</view>
                    <view class="pwa-progress">
                        <view class="pwa-progress-bar" id="pwa-progress-2" style="width: 0%"></view>
                    </view>
                    <view class="pwa-progress-text" id="pwa-progress-text-2">0 / 0 „Éï„Ç°„Ç§„É´</view>
                </view>
                <view class="pwa-step hidden" id="pwa-step-3">
                    <view class="pwa-icon">‚úÖ</view>
                    <view>„Ç§„É≥„Çπ„Éà„Éº„É´ÂÆå‰∫ÜÔºÅ</view>
                    <view>„Ç¢„Éó„É™„Çí„Éõ„Éº„É†ÁîªÈù¢„Å´ËøΩÂä†„Åß„Åç„Åæ„Åô</view>
                    <button type="button" id="pwa-add-to-home" class="primary-button" style="max-width: 100%; margin-top: 16px;">
                        „Éõ„Éº„É†ÁîªÈù¢„Å´ËøΩÂä†
                    </button>
                </view>
                <view class="pwa-step hidden" id="pwa-step-error">
                    <view class="pwa-icon">‚ùå</view>
                    <view>„Ç§„É≥„Çπ„Éà„Éº„É´„Å´Â§±Êïó„Åó„Åæ„Åó„Åü</view>
                    <view id="pwa-error-message"></view>
                    <button type="button" class="ghost-button" data-close="pwa-modal" style="margin-top: 16px;">
                        Èñâ„Åò„Çã
                    </button>
                </view>
            </view>
        </view>
    </view>

    
    

    
    
    
    
    
    
    <view id="keyboard-container" class="keyboard-container">
        
        <view id="virtual-keyboard" class="virtual-keyboard show">
        <view class="keyboard-body">
            
            <view class="keyboard-row">
                <button class="key" data-key="q">q</button>
                <button class="key" data-key="w">w</button>
                <button class="key" data-key="e">e</button>
                <button class="key" data-key="r">r</button>
                <button class="key" data-key="t">t</button>
                <button class="key" data-key="y">y</button>
                <button class="key" data-key="u">u</button>
                <button class="key" data-key="i">i</button>
                <button class="key" data-key="o">o</button>
                <button class="key" data-key="p">p</button>
            </view>
            
            <view class="keyboard-row">
                <button class="key" data-key="a">a</button>
                <button class="key" data-key="s">s</button>
                <button class="key" data-key="d">d</button>
                <button class="key" data-key="f">f</button>
                <button class="key" data-key="g">g</button>
                <button class="key" data-key="h">h</button>
                <button class="key" data-key="j">j</button>
                <button class="key" data-key="k">k</button>
                <button class="key" data-key="l">l</button>
            </view>
            
            <view class="keyboard-row">
                <button class="key key-kana-toggle" data-key="kana-toggle">
                    <text class="kana-indicator">„Ç´„Çø</text>
                </button>
                <button class="key" data-key="z">z</button>
                <button class="key" data-key="x">x</button>
                <button class="key" data-key="c">c</button>
                <button class="key" data-key="v">v</button>
                <button class="key" data-key="b">b</button>
                <button class="key" data-key="n">n</button>
                <button class="key" data-key="m">m</button>
                <button class="key key-backspace" data-key="backspace">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"/>
                        <path d="M18 9l-6 6"/>
                        <path d="M12 9l6 6"/>
                    </svg>
                </button>
            </view>
            
            <view class="keyboard-row keyboard-controls">
                <button class="key key-flick-toggle" data-key="flick-toggle" title="„Éï„É™„ÉÉ„ÇØÂÖ•Âäõ">
                    <text class="flick-icon">„Éï„É™„ÉÉ„ÇØ</text>
                </button>
                <button class="key key-space" data-key="space">
                    <text class="space-text">Space</text>
                    <text class="space-lang">A</text>
                </button>
                <button class="key key-enter" data-key="enter">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 10l-5 5 5 5"/>
                        <path d="M20 4v7a4 4 0 0 1-4 4H4"/>
                    </svg>
                </button>
            </view>
        </view>
        </view>

        
        <view id="flick-keyboard" class="flick-keyboard hidden">
        <view class="keyboard-body flick-keyboard-body">
            <view class="flick-keyboard-layout">
                
                <view class="flick-sidebar">
                    
                    <button class="key flick-function-key flick-escape" data-key="flick-escape" title="ÂèñÊ∂àÈÄâÊã©">
                        <text class="escape-text">Esc</text>
                    </button>
                    
                    <button class="key flick-function-key flick-katakana" data-key="flick-katakana" title="ÁâáÂÅáÂêçÊ®°Âºè">
                        <text class="katakana-text">„Ç´„Çø„Ç´„Éä</text>
                    </button>
                    
                    <button class="key flick-function-key flick-back" data-key="flick-back" title="ËøîÂõûÈªòËÆ§ÈîÆÁõò">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 12H5"/>
                            <path d="M12 19l-7-7 7-7"/>
                        </svg>
                    </button>
                </view>
                
                
                <view class="flick-keys-area">
                    
                    <view class="keyboard-row flick-row">
                        <button class="key flick-key" data-flick="„ÅÇ" data-flick-left="„ÅÑ" data-flick-up="„ÅÜ" data-flick-right="„Åà" data-flick-down="„Åä">„ÅÇ</button>
                        <button class="key flick-key" data-flick="„Åã" data-flick-left="„Åç" data-flick-up="„Åè" data-flick-right="„Åë" data-flick-down="„Åì">„Åã</button>
                        <button class="key flick-key" data-flick="„Åï" data-flick-left="„Åó" data-flick-up="„Åô" data-flick-right="„Åõ" data-flick-down="„Åù">„Åï</button>
                    </view>
                    
                    <view class="keyboard-row flick-row">
                        <button class="key flick-key" data-flick="„Åü" data-flick-left="„Å°" data-flick-up="„Å§" data-flick-right="„Å¶" data-flick-down="„Å®">„Åü</button>
                        <button class="key flick-key" data-flick="„Å™" data-flick-left="„Å´" data-flick-up="„Å¨" data-flick-right="„Å≠" data-flick-down="„ÅÆ">„Å™</button>
                        <button class="key flick-key" data-flick="„ÅØ" data-flick-left="„Å≤" data-flick-up="„Åµ" data-flick-right="„Å∏" data-flick-down="„Åª">„ÅØ</button>
                    </view>
                    
                    <view class="keyboard-row flick-row">
                        <button class="key flick-key" data-flick="„Åæ" data-flick-left="„Åø" data-flick-up="„ÇÄ" data-flick-right="„ÇÅ" data-flick-down="„ÇÇ">„Åæ</button>
                        <button class="key flick-key" data-flick="„ÇÑ" data-flick-up="„ÇÜ" data-flick-down="„Çà">„ÇÑ</button>
                        <button class="key flick-key" data-flick="„Çâ" data-flick-left="„Çä" data-flick-up="„Çã" data-flick-right="„Çå" data-flick-down="„Çç">„Çâ</button>
                    </view>
                    
                    <view class="keyboard-row flick-row">
                        <button class="key flick-key flick-voicing" data-flick="Â∞è">Â∞è</button>
                        <button class="key flick-key" data-flick="„Çè" data-flick-left="„Çí" data-flick-up="„Çì" data-flick-right="„Éº">„Çè</button>
                        <button class="key flick-key" data-flick="„Éº">„Éº</button>
                    </view>
                </view>
                
                
                <view class="flick-right-sidebar">
                    
                    <button class="key flick-function-key flick-delete" data-key="flick-delete" title="Âà†Èô§">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"></path>
                            <path d="M18 9l-6 6"></path>
                            <path d="M12 9l6 6"></path>
                        </svg>
                    </button>
                    
                    <button class="key flick-function-key flick-space" data-key="flick-space" title="Space">
                        <text class="space-text">Space</text>
                    </button>
                    
                    <button class="key flick-function-key flick-submit" data-key="flick-submit" >
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 10l-5 5 5 5"></path>
                            <path d="M20 4v7a4 4 0 0 1-4 4H4"></path>
                        </svg>
                    </button>
                </view>
            </view>
        </view>
        </view>
    </view>
</view>